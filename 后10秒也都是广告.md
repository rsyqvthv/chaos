# 问题

每个MP4 的前15秒都是广告，
每个MP4的后10秒也都是广告, 
如何批量删除片段操作呢？

# 答案

针对3000个视频, 似乎只有命令行了. 

我打算使用powershell+ffmpeg

而你需要截取尾部10秒, 而据我了解, ffmpeg只有从头计时, 所以我们还需要用ffprobe得到影片时长. 为了方便描述, 我将视频分成3段描述:

- A段, 每段影片开头的15秒.
- B段, 每段影片你想保留的部分.
- C段, 每段影片结尾10秒.

## 要点步骤:

确保你安装好了ffmpeg和ffprobe

### 获得总时长

并用一个变量保存这个总时长.

```powershell
$total = & ffprobe -v 0 -show_entries format=duration -of compact=p=0:nk=1 file.mp4
```

### 获得B段终点

通过powershell的运算来得到

```powershell
$b_end = $total - 10
```

## 最终代码:

所以总的来说代码是这样: 

```powershell
ls *.mp4 | % {
	$total = & ffprobe -v 0 -show_entries format=duration -of compact=p=0:nk=1 $_;
	$b_start = 15;
	$b_end = $total - 10
	ffmpeg -ss $b_start -to $b_end -i $_ -c copy $('trimmed_'+$_.name);
}
```

运行后, 前置trimmed_的视频就是去掉广告的视频. 检查无误后, 就可以将其他有广告的视频删除了.

希望对你有用.

